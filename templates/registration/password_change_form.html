{% extends "core/base.html" %}
{% load static %}

{% block title %}Cambiar contrase√±a ¬∑ AccessLedger{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'core/css/auth.css' %}">
{% endblock %}

{% block content %}
<section class="auth">
  <div class="auth__bg" aria-hidden="true"></div>

  <div class="auth__card lift-in">
    <header class="auth__header">
      <div class="auth__brand">
        <span class="brand__dot" aria-hidden="true"></span>
        <span class="auth__brandName">AccessLedger</span>
      </div>
      <h1 class="auth__title">Cambiar contrase√±a</h1>
      <p class="auth__subtitle">Elige una contrase√±a segura para tu cuenta.</p>
    </header>

    {% if form.errors %}
      <div class="alert" role="alert">
        {% for field in form %}
          {% for error in field.errors %}{{ error }} {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}{{ error }} {% endfor %}
      </div>
    {% endif %}

    <form method="post" class="auth__form" novalidate>
      {% csrf_token %}

      <div class="field">
        <label class="label" for="{{ form.old_password.id_for_label }}">Contrase√±a actual</label>
        <div class="control">
          <span class="control__icon" aria-hidden="true">üîí</span>
          {{ form.old_password }}
        </div>
      </div>

      <div class="field">
        <label class="label" for="{{ form.new_password1.id_for_label }}">Nueva contrase√±a</label>
        <div class="control">
          <span class="control__icon" aria-hidden="true">‚ú®</span>
          {{ form.new_password1 }}
        </div>

        <div class="pwd-strength">
          <div class="pwd-strength__bar" id="bar1"></div>
          <div class="pwd-strength__bar" id="bar2"></div>
          <div class="pwd-strength__bar" id="bar3"></div>
        </div>
        <div class="pwd-strength__label" id="strengthLabel"></div>

        <div class="pwd-hints">
          <div class="pwd-hint" id="hint-length">
            <span class="pwd-hint__dot"></span>M√≠nimo 8 caracteres
          </div>
          <div class="pwd-hint" id="hint-numeric">
            <span class="pwd-hint__dot"></span>No puede ser solo n√∫meros
          </div>
          <div class="pwd-hint" id="hint-common">
            <span class="pwd-hint__dot"></span>No uses contrase√±as comunes (123456, password‚Ä¶)
          </div>
          <div class="pwd-hint" id="hint-similar">
            <span class="pwd-hint__dot"></span>No puede ser similar a tu nombre de usuario
          </div>
        </div>
      </div>

      <div class="field">
        <label class="label" for="{{ form.new_password2.id_for_label }}">Confirmar nueva contrase√±a</label>
        <div class="control">
          <span class="control__icon" aria-hidden="true">‚úÖ</span>
          {{ form.new_password2 }}
        </div>
      </div>

      <button class="btn btn--primary btn--block" type="submit">
        Actualizar contrase√±a
        <span class="btn__shine" aria-hidden="true"></span>
      </button>
    </form>
  </div>
</section>
{% endblock %}

{% block extra_js %}
  <script>const USERNAME = "{{ request.user.username }}";</script>
  <script defer src="{% static 'core/js/password_change.js' %}"></script>
{% endblock %}